{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "cd0432c5_1798441b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1575067
      },
      "writtenOn": "2023-08-10T02:45:39Z",
      "side": 1,
      "message": "Hi all, this CL is to enable rvv intrinsic v0.12 in `row_rvv.cc`.",
      "revId": "6cf62b7b047cc1ebe091abd2a2c3189a6074a925",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "500399ad_de71795d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1115898
      },
      "writtenOn": "2023-08-10T20:19:40Z",
      "side": 1,
      "message": "wow... thats ugly.\n\nclip is okay, but does that generate 2 instructions in the loop now, hurting performance?\nWe rarely need to saturate, so mostly we need a rounding shift and narrow.  Rounding can be mimiced by adding 0x80, so we need a way to converting 16 bit to 8 bit.  ARM has a few ways to do this, so I suspect RVV does too.  So keep this in mind for future functions\n\nThe vlseg is ugly source but likely ends up being the same as before, and is the same as arm intrinsics.  Which is ugly, inflexible and often clang produces poor code for it, literally creating a new set of registers and copying them to/from the structure.\nIt makes me want to write RVV as inline.  Intrinics arent buying us much portability, and at the moment, are causing issues that inline would not.\nBut up to you.  If there are RVV variations coming where intrinsics help compile down to different ISA, or different compilers that are not clang based, intrinsics allow optimized code for more platforms.",
      "revId": "6cf62b7b047cc1ebe091abd2a2c3189a6074a925",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e8c3bcdd_2a64ae76",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1115898
      },
      "writtenOn": "2023-08-10T20:46:23Z",
      "side": 1,
      "message": "tested okay on emulator, but there are build warning\n\nINFO: From Compiling third_party/libyuv/files/source/row_rvv.cc:\nthird_party/libyuv/files/source/row_rvv.cc:253:47: warning: variable \u0027v_dst_ab64\u0027 is uninitialized when used here [-Wuninitialized]\n  253 |     v_dst_ab64 \u003d __riscv_vset_v_u16m2_u16m2x4(v_dst_ab64, 0, v_r_16);\n      |                                               ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:237:5: note: variable \u0027v_dst_ab64\u0027 is declared here\n  237 |     vuint16m2x4_t v_dst_ab64;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:321:45: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n  321 |     v_dst_argb \u003d __riscv_vset_v_u8m1_u8m1x4(v_dst_argb, 0, v_b);\n      |                                             ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:310:5: note: variable \u0027v_dst_argb\u0027 is declared here\n  310 |     vuint8m1x4_t v_dst_argb;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:359:43: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n  359 |   v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 3, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:357:3: note: variable \u0027v_dst_argb\u0027 is declared here\n  357 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:400:43: warning: variable \u0027v_dst_rgba\u0027 is uninitialized when used here [-Wuninitialized]\n  400 |   v_dst_rgba \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_rgba, 0, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:398:3: note: variable \u0027v_dst_rgba\u0027 is declared here\n  398 |   vuint8m2x4_t v_dst_rgba;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:445:44: warning: variable \u0027v_dst_rgb\u0027 is uninitialized when used here [-Wuninitialized]\n  445 |     v_dst_rgb \u003d __riscv_vset_v_u8m2_u8m2x3(v_dst_rgb, 0, v_b);\n      |                                            ^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:439:5: note: variable \u0027v_dst_rgb\u0027 is declared here\n  439 |     vuint8m2x3_t v_dst_rgb;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:481:16: warning: unused variable \u0027v_a\u0027 [-Wunused-variable]\n  481 |     vuint8m2_t v_a \u003d __riscv_vget_v_u8m2x4_u8m2(v_src_argb, 3);\n      |                ^~~\nthird_party/libyuv/files/source/row_rvv.cc:482:44: warning: variable \u0027v_dst_bgr\u0027 is uninitialized when used here [-Wuninitialized]\n  482 |     v_dst_bgr \u003d __riscv_vset_v_u8m2_u8m2x3(v_dst_bgr, 0, v_r);\n      |                                            ^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:475:5: note: variable \u0027v_dst_bgr\u0027 is declared here\n  475 |     vuint8m2x3_t v_dst_bgr;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:520:44: warning: variable \u0027v_dst_rgb\u0027 is uninitialized when used here [-Wuninitialized]\n  520 |     v_dst_rgb \u003d __riscv_vset_v_u8m2_u8m2x3(v_dst_rgb, 0, v_b);\n      |                                            ^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:514:5: note: variable \u0027v_dst_rgb\u0027 is declared here\n  514 |     vuint8m2x3_t v_dst_rgb;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:556:43: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n  556 |   v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 3, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:552:3: note: variable \u0027v_dst_argb\u0027 is declared here\n  552 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:610:43: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n  610 |   v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 3, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:607:3: note: variable \u0027v_dst_argb\u0027 is declared here\n  607 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:683:45: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n  683 |     v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 0, v_b);\n      |                                             ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:677:5: note: variable \u0027v_dst_argb\u0027 is declared here\n  677 |     vuint8m2x4_t v_dst_argb;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:752:44: warning: variable \u0027v_dst_rgb\u0027 is uninitialized when used here [-Wuninitialized]\n  752 |     v_dst_rgb \u003d __riscv_vset_v_u8m2_u8m2x3(v_dst_rgb, 0, v_b);\n      |                                            ^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:747:5: note: variable \u0027v_dst_rgb\u0027 is declared here\n  747 |     vuint8m2x3_t v_dst_rgb;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:812:43: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n  812 |   v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 3, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:809:3: note: variable \u0027v_dst_argb\u0027 is declared here\n  809 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:885:45: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n  885 |     v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 0, v_b);\n      |                                             ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:879:5: note: variable \u0027v_dst_argb\u0027 is declared here\n  879 |     vuint8m2x4_t v_dst_argb;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:950:43: warning: variable \u0027v_dst_rgba\u0027 is uninitialized when used here [-Wuninitialized]\n  950 |   v_dst_rgba \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_rgba, 0, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:947:3: note: variable \u0027v_dst_rgba\u0027 is declared here\n  947 |   vuint8m2x4_t v_dst_rgba;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1014:16: warning: variable \u0027v_dst_rgb\u0027 is used uninitialized whenever function \u0027libyuv::I422ToRGB24Row_RVV\u0027 is called [-Wsometimes-uninitialized]\n 1014 |   vuint8m2x3_t v_dst_rgb;\n      |   ~~~~~~~~~~~~~^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1021:44: note: uninitialized use occurs here\n 1021 |     v_dst_rgb \u003d __riscv_vset_v_u8m2_u8m2x3(v_dst_rgb, 0, v_b);\n      |                                            ^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1014:3: note: variable \u0027v_dst_rgb\u0027 is declared here\n 1014 |   vuint8m2x3_t v_dst_rgb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1074:16: warning: variable \u0027v_dst_argb\u0027 is used uninitialized whenever function \u0027libyuv::I400ToARGBRow_RVV\u0027 is called [-Wsometimes-uninitialized]\n 1074 |   vuint8m2x4_t v_dst_argb;\n      |   ~~~~~~~~~~~~~^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1095:45: note: uninitialized use occurs here\n 1095 |     v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 0, v_out);\n      |                                             ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1074:3: note: variable \u0027v_dst_argb\u0027 is declared here\n 1074 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1154:43: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n 1154 |   v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 3, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1153:3: note: variable \u0027v_dst_argb\u0027 is declared here\n 1153 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1217:43: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n 1217 |   v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 3, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1214:3: note: variable \u0027v_dst_argb\u0027 is declared here\n 1214 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1277:16: warning: variable \u0027v_dst_rgb\u0027 is used uninitialized whenever function \u0027libyuv::NV12ToRGB24Row_RVV\u0027 is called [-Wsometimes-uninitialized]\n 1277 |   vuint8m2x3_t v_dst_rgb;\n      |   ~~~~~~~~~~~~~^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1284:44: note: uninitialized use occurs here\n 1284 |     v_dst_rgb \u003d __riscv_vset_v_u8m2_u8m2x3(v_dst_rgb, 0, v_b);\n      |                                            ^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1277:3: note: variable \u0027v_dst_rgb\u0027 is declared here\n 1277 |   vuint8m2x3_t v_dst_rgb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1340:43: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n 1340 |   v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 3, v_a);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1337:3: note: variable \u0027v_dst_argb\u0027 is declared here\n 1337 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1401:16: warning: variable \u0027v_dst_rgb\u0027 is used uninitialized whenever function \u0027libyuv::NV21ToRGB24Row_RVV\u0027 is called [-Wsometimes-uninitialized]\n 1401 |   vuint8m2x3_t v_dst_rgb;\n      |   ~~~~~~~~~~~~~^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1408:44: note: uninitialized use occurs here\n 1408 |     v_dst_rgb \u003d __riscv_vset_v_u8m2_u8m2x3(v_dst_rgb, 0, v_b);\n      |                                            ^~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1401:3: note: variable \u0027v_dst_rgb\u0027 is declared here\n 1401 |   vuint8m2x3_t v_dst_rgb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1625:40: warning: variable \u0027v_dst\u0027 is uninitialized when used here [-Wuninitialized]\n 1625 |     v_dst \u003d __riscv_vset_v_u8m2_u8m2x3(v_dst, 0, v_r);\n      |                                        ^~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1624:5: note: variable \u0027v_dst\u0027 is declared here\n 1624 |     vuint8m2x3_t v_dst;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:1730:40: warning: variable \u0027v_dst\u0027 is uninitialized when used here [-Wuninitialized]\n 1730 |     v_dst \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst, 0, v_b);\n      |                                        ^~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1729:5: note: variable \u0027v_dst\u0027 is declared here\n 1729 |     vuint8m2x4_t v_dst;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:1828:38: warning: variable \u0027v_dst\u0027 is uninitialized when used here [-Wuninitialized]\n 1828 |   v_dst \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst, 3, v_a);\n      |                                      ^~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1827:3: note: variable \u0027v_dst\u0027 is declared here\n 1827 |   vuint8m2x4_t v_dst;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:1925:40: warning: variable \u0027v_dst\u0027 is uninitialized when used here [-Wuninitialized]\n 1925 |     v_dst \u003d __riscv_vset_v_u8m4_u8m4x2(v_dst, 0, v_u);\n      |                                        ^~~~~\nthird_party/libyuv/files/source/row_rvv.cc:1921:5: note: variable \u0027v_dst\u0027 is declared here\n 1921 |     vuint8m4x2_t v_dst;\n      |     ^\nthird_party/libyuv/files/source/row_rvv.cc:2010:16: warning: unused variable \u0027v_a\u0027 [-Wunused-variable]\n 2010 |     vuint8m2_t v_a \u003d __riscv_vget_v_u8m2x4_u8m2(v_src_argb, 3);\n      |                ^~~\nthird_party/libyuv/files/source/row_rvv.cc:2100:16: warning: unused variable \u0027v_a\u0027 [-Wunused-variable]\n 2100 |     vuint8m2_t v_a \u003d __riscv_vget_v_u8m2x4_u8m2(v_src_rgba, 0);\n      |                ^~~\nthird_party/libyuv/files/source/row_rvv.cc:2273:43: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n 2273 |   v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 3, v_255);\n      |                                           ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:2268:3: note: variable \u0027v_dst_argb\u0027 is declared here\n 2268 |   vuint8m2x4_t v_dst_argb;\n      |   ^\nthird_party/libyuv/files/source/row_rvv.cc:2417:45: warning: variable \u0027v_dst_argb\u0027 is uninitialized when used here [-Wuninitialized]\n 2417 |     v_dst_argb \u003d __riscv_vset_v_u8m2_u8m2x4(v_dst_argb, 0, v_b);\n      |                                             ^~~~~~~~~~\nthird_party/libyuv/files/source/row_rvv.cc:2397:5: note: variable \u0027v_dst_argb\u0027 is declared here\n 2397 |     vuint8m2x4_t v_dst_argb;\n      |     ^\n30 warnings generated.",
      "revId": "6cf62b7b047cc1ebe091abd2a2c3189a6074a925",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5aa60075_5db3fa45",
        "filename": "include/libyuv/row.h",
        "patchSetId": 1
      },
      "lineNbr": 795,
      "author": {
        "id": 1115898
      },
      "writtenOn": "2023-08-10T20:19:40Z",
      "side": 1,
      "message": "typo: introduced",
      "range": {
        "startLine": 795,
        "startChar": 30,
        "endLine": 795,
        "endChar": 40
      },
      "revId": "6cf62b7b047cc1ebe091abd2a2c3189a6074a925",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}